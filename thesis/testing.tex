% Testing Chapter

\section{Traffic analysis}

TODO Capture traffic via VirtualBox PCAP dump and take a peek inside.

\begin{table}[!ht]
\label{tab:dhcp_request}
  \begin{adjustwidth}{-3.5cm}{}
    \begin{scriptsize}
\begin{verbatim}
IP 0.0.0.0.bootpc > broadcasthost.bootps: BOOTP/DHCP, Request from 08:00:27:6f:16:b8 (oui Unknown), length 399
IP 10.0.2.2.bootps > 10.0.2.15.bootpc: BOOTP/DHCP, Reply, length 548
IP 0.0.0.0.bootpc > broadcasthost.bootps: BOOTP/DHCP, Request from 08:00:27:6f:16:b8 (oui Unknown), length 399
IP 10.0.2.2.bootps > 10.0.2.15.bootpc: BOOTP/DHCP, Reply, length 548
IP 0.0.0.0.bootpc > broadcasthost.bootps: BOOTP/DHCP, Request from 08:00:27:6f:16:b8 (oui Unknown), length 411
IP 10.0.2.2.bootps > 10.0.2.15.bootpc: BOOTP/DHCP, Reply, length 548
ARP, Request who-has 10.0.2.2 tell 10.0.2.15, length 28
ARP, Reply 10.0.2.2 is-at 52:54:00:12:35:02 (oui Unknown), length 28
\end{verbatim}
    \end{scriptsize}
  \end{adjustwidth}
  \begin{center}
    \caption{Traffic capture showing DHCP initialization}
  \end{center}
\end{table}

\begin{table}[!ht]
  \label{tab:dhcp_request}
  \begin{adjustwidth}{-3.5cm}{}
    \begin{scriptsize}
\begin{verbatim}
ARP, Request who-has 10.0.2.2 tell 10.0.2.15, length 28
ARP, Reply 10.0.2.2 is-at 52:54:00:12:35:02 (oui Unknown), length 28
\end{verbatim}
    \end{scriptsize}
  \end{adjustwidth}
  \begin{center}
    \caption{Client doing ARP request for learning gateway's MAC address}
  \end{center}
\end{table}


\begin{table}[!ht]
  \label{tab:dns_request}
  \begin{adjustwidth}{-3.5cm}{}
    \begin{scriptsize}
\begin{verbatim}
IP 10.0.2.15.56359 > 172.17.1.1.domain: 63232+ A? raw.githubusercontent.com. (43)
IP 172.17.1.1.domain > 10.0.2.15.56359: 27875 2/4/0 CNAME github.map.fastly.net., A 23.235.43.133 (177)
\end{verbatim}
    \end{scriptsize}
  \end{adjustwidth}
  \begin{center}
    \caption{Client doing DNS request to determine IPv4 address for
      raw.githubusercontent.com}
  \end{center}
\end{table}


\begin{table}[!ht]
  \label{tab:dns_request}
  \begin{adjustwidth}{-3.5cm}{}
    \begin{scriptsize}
\begin{verbatim}
IP 10.0.2.15.54313 > 172.17.1.1.domain: 15216+ A? mirror.centos.org. (35)
IP 172.17.1.1.domain > 10.0.2.15.54313: 15216 1/0/0 A 93.113.36.66 (51)
IP 10.0.2.15.50434 > mirrors.ch-center.com.http: Flags [S], seq 1040635034, win 65532,
    options [nop,nop,TS val 996012 ecr 0,nop,nop,sackOK,nop,wscale 9,mss 1460], length 0
IP mirrors.ch-center.com.http > 10.0.2.15.50434: Flags [S.], seq 448001, ack 1040635035, 
    win 65535, options [mss 1460], length 0
IP 10.0.2.15.50434 > mirrors.ch-center.com.http: Flags [P.], seq 1:135, ack 1, win 65532, 
    length 134: HTTP: GET /centos/7/os/x86_64/isolinux/vmlinuz HTTP/1.1
IP mirrors.ch-center.com.http > 10.0.2.15.50434: Flags [.], ack 135, win 65535, length 0
\end{verbatim}
    \end{scriptsize}
  \end{adjustwidth}
  \begin{center}
    \caption{Client doing DNS and HTTP request to receive CentOS 7 kernel}
  \end{center}
\end{table}

\section{Man in the middle attacks}

\subsection{Attack against TLS}

TODO Invalid certificate on remote server

\subsection{Malicious binaries over HTTP}

TODO Test what happens if Linux distribution mirror shares forged binary.
