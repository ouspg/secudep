% Introduction Chapter

\iffalse
FIXME: TODO REMOVE THIS LIST
\begin{itemize}
\item INTRODUCTION: The Setting - bird eye's view - the challenge to be tackled / thing to be be improved in general
\item INTRODUCTION: Past research done
\item INTRODUCTION: Gap in knowledge/problem not yet solved
\item INTRODUCTION: Purpose and method of this work
\item INTRODUCTION: More detailed description what was done
\item INTRODUCTION: Results acquired
\item INTRODUCTION: Analysis and limitations of the result (Mostly relocate to Conclusions)
\item INTRODUCTION: Value (Mostly relocate to Conclusions)
\end{itemize}
\fi

FIXME: Intro infosec (narrow infosec to thesis' context)
FIXME: open acronyms

Loading operating system into computer remotely over network
(``network booting'', ``diskless booting'') has been used for
decades. Network booting can be used to bootstrap operating system
installation (``network installation'') or it could be used for
diskless nodes to load the operating system and run it using disk
provided by server~\cite{anvin2008x86}.

Usually network installation systems are built to serve single
organization (e.g.\ single business) inside their own networks
(business intranet) to achieve repeatable and homogeneous
installations. Installation preferably is expected be as easy and as
fast as possible, and require a human interaction as little as
possible.

Many Linux distributions offer ``net install'' which is a small image
used to boot the computer into a state where rest of the installation
software and packages can be downloaded directly from Internet. After
downloading files the installer is executed. It runs a set of steps
and finally a fresh operating system installation is completed on the
computer.

This thesis has four parts. Introduction looks at history and current
state of installation systems (how it has been done in the past and
how it works currently), then identifies what network based risks
there are to installation system. The next chapter contains design
principles of proof of concept installation system which tries to
mitigate against earlier identified risks discussed. Then the proof of
concept implementation is compared against two other installation
systems. And finally in conclusions and discussion chapter the
findings are summarized and recommendations are given for new research
and how security of installation systems could be improved further.

The work done is a practical hands on study of how installation
systems work and how to improve the security of these systems.

\section{Involved Protocols}

Multiple network protocols have been developed and used to allow
booting using IP network. Early published standards include RARP (``A
Reverse Address Resolution Protocol'', RFC903, published
1984~\cite{RFC903}) and BOOTP (``Bootstrap Protocol'', RFC951,
published 1985~\cite{RFC951}) which could be used to allow ``a
diskless client machine to discover its own IP
address''~\cite{RFC951}, TFTP (``Trivial File Transfer Protocol'',
RFC783, published 1981~\cite{RFC783}) ``may be used to move files
between machines on different networks implementing
UDP.''~\cite{RFC783}.

Later developments include RARP and BOOTP to be superseded by DHCP
(``Dynamic Host Configuration Protocol'', RFC1531, published
1993~\cite{RFC1531}) and TFTP superseded by NFS (``Network File
System'', RFC1094, published 1989~\cite{RFC1094}) which ``provides
transparent remote access to shared files across
networks.''~\cite{RFC1094} PXE (``Preboot Execution
Environment''~\cite{PXEspec}) is specification from Intel Corporation
to standardize preboot environment for network booting. In some cases
TFTP or NFS or both can be replaced with HTTP (``Hypertext Transfer
Protocol''~\cite{RFC1945}\cite{RFC2616}).


\section{Risks}

FIXME: Role of human?

CIA triad~\cite{cia-triad} divides network security into three
elements: confidentiality, integrity and availability~\cite{anderson}.

Confidentiality means that the sender of the message encrypts the
content so only a receiver with correct key can decrypt the content
and see the message. Confidentiality can be achieved in network
security for example by using TLS protocol~\cite{RFC5246} to encrypt
network traffic.

Integrity control guarantees that the message cannot be modified
during transfer. It consist two parts: Non-repudiation and
authenticity.

Non-repudiation ensures proof of integrity and the origin of
data. This is usually achieved with using authentication and integrity
control. Digital signatures~\cite{Diffie2006}\cite{Goldwasser1988} can
provide non-repudiation. Standards such as S/MIME~\cite{RFC5751} or
OpenPGP~\cite{RFC4880} can be used for digital signature format.

Authenticity ensures receiving, transmitting or both parties determine
they are communicating with intended party before exchanging any
confidential messages. TLS protocol provides means to verify
authenticity of communicating parties.

Availability means that the systems are up and operational. Perfect
security could be achieved by turning everything off, but usability
would be zero. It's important to ensure availability so that network
services can be used. Availability can be achieved by allocating
enough human and computing resources to operate the services.

Risks can be identified in all components from hardware to operating
system vulnerabilities. Table~\ref{tab:risks_table} lists some
common known attacks which could be targeted towards network booting
or network installation systems.

All components in table~\ref{tab:risks_table} are susceptible to to
issues with availability. For example, if the network or one or more
components are not available, the whole stack of components is
inoperative.

\begin{table}[!ht]
  % Add some padding to the table cells:
  \def\arraystretch{1.1}%
  \begin{center}
    \begin{tabular}{| l | l | l |}
      \hline
      Component   & Role               & Risks                      \\
      \hline
      HTTP        & File transfer      & confidentiality, integrity \\
      DNS         & Name service       & non-repudiation            \\
      NFS         & File transfer      & confidentiality, integrity \\
      TFTP        & File transfer      & confidentiality, integrity \\
      DHCP        & Address resolution & non-repudiation            \\
      \hline
    \end{tabular}
    \caption{Roles and risks of various components used in operating
      system installation over network\label{tab:risks_table}}
  \end{center}
\end{table}

FIXME: explain availability

FIXME: how secudep handles the risks (in implementation chapter)

DHCP and DNS protocols could be used to redirect (``hijack'') future
communications into malicious
services~\cite{green2005dns}\cite{ornaghi2003man}. DHCP is commonly
used to assign IP address to client and give various information (TFTP
server's IP address, DNS servers' IP addresses). Malicious DHCP could
take over following TFTP and DNS communications. DNS has many uses,
but commonly it's used to translate host name into IP
address. Malicious DNS server could redirect future communications
into malicious services.

TFTP, NFS and HTTP protocols could be used to deliver malicious files
which when executed in target system compromise the operating system
installation or even infect the hardware the operation was performed
in.

There has been development to secure DHCP and DNS.\@ That however
requires the network in question to be configured to take these
security measurements in action. But the risks can be detected by
other components (e.g.\ using TLS's server authentication, and digital
signatures) so there's no need to changes to network
configuration. Thus the installation can be done securely in any
network and if something malicious is detected the installation
process can halted.

Hardware (e.g.\ physical server or laptop) and peripherals (e.g.\
displays, keyboards, mice, removable medias) can have backdoored
firmware~\cite{swierczynski2016interdiction}. The backdoors could have
been installed already on factory or firmware was infected with some
malware previously ran on the machine. Mitigations for risks against
hardware is out of scope of this work.


\section{Current state}

FIXME: what is different in the cloud to earlier installs?
FIXME: historical development (what was before, what's now?)

Software deployment technologies~\cite{SoftDep}, securing virtual
machines~\cite{Garfinkel2005} as well as cloud computing security
challenges~\cite{Owens2010}\cite{Hashizume2013} have been widely
studied. However, network installation of operating system is still
much the same as in the 1980s and it's the base for any software
deployment or virtual machine installation to get operating system
installed securely.

FIXME: Why Alpine?

Alpine Linux's PXE Boot HOWTO~\cite{alpine-pxe-boot-howto} summarizes
the current situation:

\begin{quote}
Alpine can be PXE booted starting with Alpine 2.6-rc2. In order to
accomplish this you must complete the following steps:

\begin{enumerate}
\item Set up a DHCP server and configure it to support PXE boot.
\item Set up a TFTP server to serve the PXE boot loader.
\item Set up an HTTP server to serve the rest of the boot files.
\item Set up an NFS server from which Alpine can load kernel modules.
\item Configure mkinitfs to generate a PXE-bootable initrd.
\end{enumerate}
\end{quote}

Alpine Linux's documentation was chosen as an example because of their
claim that it's ``for power users who appreciate security, simplicity
and resource efficiency''~\cite{alpine-about}. Similar setup is
required for other Linux distributions like Red
Hat~\cite{redhat-network-install}, and for Microsoft
Windows~\cite{windows-network-install}.

As we can see, the whole process still relies on old protocols DHCP,
TFTP, HTTP and NFS developed around 1980--1990. However, these
protocols provide no security and should not be used in networks.

FIXME: Intro infosec

TFTP, NFS and HTTP protocols could be replaced with HTTPS (HTTP over
TLS) where TLS (Transport Layer Security Protocol~\cite{RFC5246})
provides communications security using cryptography and authentication
of one or both communicating parties.

DHCP is the standard protocol to centrally manage IP addresses for
clients. It's difficult to replace so it's shortcomings need to be
countered with other protocols.

Also, DNS (Domain Name System, RFC1035~\cite{rfc1035}) is a vital
protocol to the internet. It provides translation from name to IP
addresses and back (and other name services). DNS is also de facto
standard. Work to protect DNS traffic has been done (DNSSEC,
RFC4035~\cite{rfc4035}) and DNSSEC is slowly getting a foothold to
protect DNS communications. The risk for DNS in installation systems
is MitM attack. Without DNSSEC it's possible to continue using DNS and
use other means outside of DNS protocol to verify DNS is working as it
should.

Shortcomings of all these protocols and how to mitigate against the
risks are discussed later.

\section{Challenging environments}

Computer networks are not safe nor secure~\cite{beyondcorp}. Internet
being the most unsafe of networks. It requires only one compromised
device in a network to make the whole network unsafe. Connections in
the internet do not see national borders and travel through different
areas of laws and regulations. Protocol packets are passed from one
internet service provider to another. On every step of the connection
someone might be listening or even altering the connection to ones own
agendas. It might be governmental body (like NSA's PRISM
program~\cite{nsa-prism}), criminal organization who have gained
foothold on point of network or simply curious individual just being
able to do so.

Same problems can also be present in networks like corporate intranets
where both government and criminal organizations might have gained
foothold to operate. In USENIX Enigma 2016 conference Rob Joyce, Chief
of Tailored Access Operations in National Security
Agency~\cite{nsa-tao} describes how his team infiltrates networks and
moves there laterally to gain what they are after. Therefore intranets
should be treated with same level of mistrust as internet.


\section{Mitigation}

FIXME: Role of humans?

Risks can be mitigated by using trusted media, secure communication
channel and cryptographically signed files.

Boot environment is loaded from trusted media, for example using
prebuilt USB mass media. This media contains software and files to
safely load next steps required to load operating system kernel and
other files safely over network.

Network communication is done using HTTPS with X.509 certificate
pinning. This authenticates the remote server and makes it harder to
MitM attack the connection. If secure channel can't be established,
the boot process should be halted.

Signed files are used to ensure authenticity of files used for
booting. For example many Linux distribution mirrors only provide
files via HTTP or FTP servers which are susceptible to MITM attack. If
signature check fails the boot process should be halted.


\section{Comparison to virtualization and cloud}

FIXME: Thesis versus Google Cloud / Amazon

Installing operating system to virtual machine (in a cloud or other
virtualization platform) enjoys many benefits compared to installation
to a physical hardware. Virtualization gives easier ``programmable''
access to every state of virtual machine installation from setting up
the machine itself and it's parameters (like processors, memory
amount, disk space, network) to pre-building ready operating system
images (machine images) to be booted in the cloud. This is called
``Infrastructure as Code'' or IaC~\cite{spinellis}.

Infrastructure as Code can be achieved for example with tools like
Packer~\cite{packer} which can be used to build machine images and
Terraform~\cite{terraform} to set up virtual machines and launch
machine images to produce running virtual machines. Both tools use
simple description language where operations can be specified and then
ran using the tool itself.

Physical computer however usually require physical access to be able
to turn it on, plug in devices and cables, and to control the first
stages of startup before operating system is running.
